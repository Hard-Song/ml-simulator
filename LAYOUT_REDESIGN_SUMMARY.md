# 前端布局重构总结

## 更新内容

已完全重构前端页面，实现了更直观的布局和每个模型的独立能力参数配置。

## 新布局设计

### 页面结构

```
┌─────────────────────────────────────────────────────────────┐
│ 导航栏                                                         │
└─────────────────────────────────────────────────────────────┘

┌──────────────┬───────────────────────────────────────────────┐
│              │  第一行                                       │
│   左侧       │  ┌─────────────────────────────────────┐     │
│  (25%)       │  │  🤖 模型能力配置                     │     │
│              │  │  ┌────┐ ┌────┐ ┌────┐             │     │
│ ⚙️ 任务配置  │  │  │SVM │ │RF  │ │LGBM│ ...          │     │
│              │  │  └────┘ └────┘ └────┘             │     │
│ - 任务类型   │  │                                     │     │
│ - 样本量     │  │  [每个模型卡片可展开详细参数]        │     │
│ - 难度参数   │  │                                     │     │
│              │  │  [重置所有] [运行] [导出]          │     │
│              │  └─────────────────────────────────────┘     │
└──────────────┴───────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  第二行：📈 对比结果                                          │
│  ┌───────────────────────────────────────────────┐          │
│  │  表格                                        │          │
│  └───────────────────────────────────────────────┘          │
│  ┌────────────┐ ┌────────────┐ ┌──────────────────┐        │
│  │  图表1     │ │  图表2     │ │  雷达图          │        │
│  └────────────┘ └────────────┘ └──────────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

### 布局特点

1. **左侧：任务配置面板**（固定，不滚动）
   - 任务类型、样本量
   - 学习难度参数
   - 类别分布配置

2. **右侧上方：模型能力配置**（核心区域）
   - 每个模型一个独立卡片
   - 卡片可折叠展开
   - 4个能力参数滑块
   - 选中后高亮显示

3. **下方：对比结果**
   - 动态表格
   - 3个交互式图表

## 核心功能

### 1. 每个模型独立配置能力参数

#### 模型卡片
- **渐变背景头部**：美观且易于识别
- **复选框**：选择是否参与对比
- **可折叠**：点击头部展开/收起参数
- **选中状态**：卡片边框变蓝，背景变灰

#### 能力参数（4个）
每个模型有4个独立的能力参数滑块：

1. **Bias (偏差)** [0-1]
   - 越高：欠拟合风险越高
   - 说明：模型对真实类别的预测偏移

2. **Variance (方差)** [0-1]
   - 越高：过拟合风险越高
   - 说明：模型预测的稳定性

3. **Capacity (能力)** [0-1]
   - 越高：学习能力越强
   - 说明：模型的表达能力上限

4. **Noise Tol (容错)** [0-1]
   - 越高：对噪声越不敏感
   - 说明：抗干扰能力

#### 实时反馈
- 滑动滑块 → 参数值实时更新
- 不同模型的参数互不影响
- 每个模型保留独立的配置状态

### 2. 预定义模型画像

每个模型加载时有默认的能力参数：

| 模型 | Bias | Variance | Capacity | Noise Tol |
|------|------|----------|----------|------------|
| SVM | 0.5 | 0.2 | 0.6 | 0.4 |
| RF | 0.3 | 0.4 | 0.7 | 0.8 |
| LGBM | 0.3 | 0.3 | 0.8 | 0.6 |
| DNN | 0.2 | 0.7 | 0.95 | 0.5 |
| Transformer | 0.2 | 0.9 | 0.98 | 0.4 |
| LogReg | 0.5 | 0.1 | 0.5 | 0.5 |
| XGBoost | 0.3 | 0.3 | 0.8 | 0.7 |
| CatBoost | 0.3 | 0.25 | 0.78 | 0.75 |

### 3. 批量操作

**展开全部 / 收起全部**
- 一键展开所有模型卡片
- 一键收起所有模型卡片

**重置所有参数**
- 一键将所有模型参数恢复为默认值
- 弹出确认对话框防止误操作

### 4. 视觉反馈

**选中状态**
- 卡片边框：蓝色（#0d6efd）
- 卡片背景：浅灰色（#f8f9fa）

**悬停效果**
- 卡片阴影增强
- 提升交互感

**参数值显示**
- 蓝色粗体
- 实时更新

## 后端API更新

### 新增请求字段

```json
{
  "models": ["lgbm", "rf"],
  "models_config": {  // 新增：每个模型的独立配置
    "lgbm": {
      "bias": 0.3,
      "variance": 0.3,
      "capacity": 0.8,
      "noise_tolerance": 0.6
    },
    "rf": {
      "bias": 0.4,
      "variance": 0.5,
      "capacity": 0.7,
      "noise_tolerance": 0.8
    }
  }
}
```

### 兼容性

- 保留 `custom_profile` 字段（全局配置）
- `models_config` 优先级更高
- 完全向后兼容

## 使用场景示例

### 场景 1：对比高方差与低方差模型

**配置**：
1. 选择 DNN 和 SVM
2. DNN：variance = 0.7（高方差）
3. SVM：variance = 0.2（低方差）
4. 运行模拟

**预期结果**：
- SVM 更稳定
- DNN 可能在训练集上表现更好

### 场景 2：调试特定参数的影响

**步骤**：
1. 选择一个模型（如 LGBM）
2. 固定其他参数
3. 调整 capacity 从 0.5 → 0.9
4. 每次调整后运行模拟
5. 观察性能变化

### 场景 3：为每个模型设置最优参数

**方法**：
- DNN: bias=0.2, variance=0.5（降低方差）
- RF: bias=0.3, variance=0.4（保持）
- XGBoost: bias=0.25, variance=0.35（微调）

## 优势总结

### 1. 更直观的布局
- ✅ 参数配置在中心位置
- ✅ 结果在下方，便于查看
- ✅ 布局清晰，重点突出

### 2. 每个模型独立配置
- ✅ 不再强制所有模型使用相同参数
- ✅ 可以真实反映不同模型的特性
- ✅ 支持更精细的实验设计

### 3. 更好的交互体验
- ✅ 卡片式设计，美观易用
- ✅ 可折叠，节省空间
- ✅ 实时反馈，参数值清晰可见

### 4. 批量操作
- ✅ 展开/收起全部
- ✅ 重置所有参数
- ✅ 一键运行/导出

## 文件变更

### 更新的文件

1. **templates/index.html**
   - 全新的布局结构
   - 模型卡片设计
   - 内联样式

2. **static/js/index.js**
   - 模型卡片生成逻辑
   - 每个模型独立参数存储
   - 更新的 buildRequestData

3. **app.py**
   - 支持 models_config 参数
   - 向后兼容 custom_profile

### 保留的文件

- `static/css/style.css` - 全局样式
- `ml_simulator.py` - 核心计算逻辑

## 下一步

建议的功能增强：

1. **配置保存/加载**
   - 保存当前所有模型配置
   - 导入/导出配置文件

2. **配置预设**
   - 提供"保守"、"平衡"、"激进"等预设
   - 一键应用到所有模型

3. **对比历史**
   - 记录每次运行的配置和结果
   - 支持历史对比

4. **响应式优化**
   - 移动端适配
   - 更好的小屏幕体验

## 测试建议

1. **基本功能测试**
   - 选择模型 → 展开/收起
   - 调整参数 → 检查值更新
   - 运行模拟 → 查看结果

2. **多模型对比**
   - 选择 3-4 个模型
   - 设置不同参数
   - 对比结果差异

3. **参数影响实验**
   - 固定其他参数
   - 调整一个参数
   - 多次运行观察趋势

4. **边界情况**
   - 不选择任何模型 → 应提示
   - 所有参数设为 0 或 1 → 观察结果
   - 极端不均衡数据

## 常见问题

### Q: 为什么卡片默认是折叠的？

A: 为了节省屏幕空间。你可以：
- 点击头部展开/收起单个卡片
- 使用"展开全部"按钮展开所有

### Q: 如何快速恢复默认参数？

A: 两种方法：
1. 单个模型：点击卡片内的"重置为默认值"
2. 所有模型：点击"重置所有参数"按钮

### Q: 可以保存我的配置吗？

A: 当前版本不支持，但你可以：
- 记录下关键参数
- 或者我们可以添加此功能

### Q: 模型太多，页面太长怎么办？

A: 你可以：
- 使用"收起全部"只看模型列表
- 只展开正在调整的模型
- 使用浏览器缩放功能
